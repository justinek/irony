scale_color_hue(name="Pun type", breaks=c("0", "1"), labels=c("Original", "Modified"))
## weighted relatedness of unobserved homophone
summary(lm(data=dw, funniness_rating ~ unobserved_weighted))
ggplot(dw, aes(x=unobserved_weighted, y=funniness_rating, color=original)) +
geom_point() +
theme_bw() +
scale_color_hue(name="Pun type", breaks=c("0", "1"), labels=c("Original", "Modified"))
## difference in weighted relatedness of observed and unobserved homophone
dw$difference = dw$observed_weighted - dw$unobserved_weighted
summary(lm(data=dw, funniness_rating ~ dw$difference))
ggplot(dw, aes(x=difference, y=funniness_rating, color=original)) +
geom_point() +
theme_bw() +
scale_color_hue(name="Pun type", breaks=c("0", "1"), labels=c("Original", "Modified"))
setwd("~/Dropbox/Work/Grad_school/Research/Computational poetics/Analyses")
library(ggplot2)
library(plyr)
library(reshape2)
source("~/Dropbox/Work/Grad_school/Research/Utilities/summarySE.R")
style <- read.csv("~/Dropbox/Work/Grad_school/Research/Computational poetics/Data/allFeatures.csv")
style$Type <- factor(style$Type, levels=c("19th", "Poet", "Amateur"),
labels=c("19th century professional", "Contemporary professional", "Contemporary amateur"))
style$imagist <- factor(style$imagist, levels=c(0, 1), labels=c("no", "yes"))
items <- style[,1:6]
measures <- scale(style[,7:ncol(style)])
style.z <- cbind(items, measures)
head(style)
style.19 <- subset(style, Type=="19th century professional")
style.21 <- subset(style, Type=="Contemporary professional")
style.21a <- subset(style, Type=="Contemporary amateur")
#############
# Poem length
#############
mean(style.19$numWords)
min(style.19$numWords)
max(style.19$numWords)
mean(style.21$numWords)
min(style.21$numWords)
max(style.21$numWords)
mean(style.21a$numWords)
min(style.21a$numWords)
max(style.21a$numWords)
################
# Z score
################
items <- style[,1:6]
measures <- scale(style[,7:ncol(style)])
style.z <- cbind(items, measures)
style <- style.z
#############
# Subset into categories
#############
style.19 <- subset(style, Type=="19th century professional")
style.21 <- subset(style, Type=="Contemporary professional")
style.21a <- subset(style, Type=="Contemporary amateur")
##############
# Compare 19th century imagists to non
##############
ggplot(style.19, aes(x=year, y=perfectEndRhymeFreq, color=imagist)) +
geom_point() +
theme_bw()
with(style.19, cor.test(year, concreteness))
with(style.19, cor.test(year, concreteness))
with(style.19, cor.test(year, perfectEndRhymeFreq))
head(style)
with(style, cor.test(year, concreteness))
with(style.21, cor.test(year, concreteness))
with(style.19, cor.test(year, concreteness))
measure.summary <- summarySE(style, measurevar="concreteness", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
scale_shape_manual(values=c(10, 19)) +
scale_linetype_manual(values=c(3, 2)) +
scale_color_manual(values=c("#023858", "#fb9a99"))
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Concreteness (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19)) +
scale_linetype_manual(values=c(3, 2)) +
scale_color_manual(values=c("#023858", "#fb9a99"))
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Concreteness (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"))
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Concreteness (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2)) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Concreteness (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
head(style )
measure.summary <- summarySE(style, measurevar="emotWords", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Concreteness (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Emotion words (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
measure.summary <- summarySE(style, measurevar="endRhymeFreq", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Emotion words (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
measure.summary <- summarySE(style, measurevar="soundDevicesFreq", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Emotion words (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Sound devices (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
measure.summary <- summarySE(style, measurevar="slantEndRhymeFreq", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Sound devices (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Slant end rhyme (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
measure.summary <- summarySE(style, measurevar="perfectEndRhymeFreq", groupvars=c("time", "expertise"))
colnames(measure.summary)[4] <- "measure"
# for plotting purposes
dummy <- measure.summary[1,]
dummy$expertise <- "amateur"
measure.summary <- rbind(measure.summary, dummy)
ggplot(measure.summary, aes(x=time, y=measure, shape=expertise, color=time)) +
geom_line(aes(group=expertise, linetype=expertise), color="gray", size=1) +
geom_point(size=6) +
geom_errorbar(aes(ymin=measure-se, ymax=measure+se), width=0.05) +
theme_bw() +
ylab("Slant end rhyme (z-scored)") +
xlab("Time period") +
scale_shape_manual(values=c(10, 19), name="Expertise") +
scale_linetype_manual(values=c(3, 2), guide=FALSE) +
scale_color_manual(values=c("#023858", "#fb9a99"), guide=FALSE)
source("~/Dropbox/Work/Grad_school/Research/Utilities/summarySE.R")
setwd("~/Dropbox/Work/Grad_school/Research/Irony/analyses")
d <- read.csv("../data/priors/long.csv")
head(d)
d$stateRating <- factor(d$stateRating, labels=c("terrible", "bad", "neutral", "good", "amazing"))
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_histogram() +
facet_grid(.~imageID) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(formatter = 'percent') +
facet_grid(imageID~.) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=percent) +
facet_grid(imageID~.) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
scale_y_continuous(labels=percent_format()) +
facet_grid(imageID~.) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
#scale_y_continuous(labels=percent_format()) +
facet_grid(imageID~.) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/sum(..count..))) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/20)) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
?table
with(d, table(imageID, rating))
with(d, table(imageID, stateRating))
numSubjects <- length(unique(d$workerID))
numSubjects
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..)/numSubjects)) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
# plot distribution over states
ggplot(d, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..) / 19)) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
with(d, table(imageID, stateRating))
prob.table(with(d, table(imageID, stateRating)))
prop.table(with(d, table(imageID, stateRating)))
with(d, table(imageID, stateRating)) / numSubjects
stateDists <- with(d, table(imageID, stateRating)) / numSubjects
comps <- princomp(data=d, ~ sad + disgusted + angry + neutral + content + happy + excited, cor=FALSE, scores=TRUE)
summary(comps)
biplot(comps)
scores <- summary(comps)$scores
head(scores)
priors <- read.csv("../data/priors/long.csv")
numSubjects <- length(unique(priors$workerID))
priors$stateRating <- factor(priors$stateRating, labels=c("terrible", "bad", "neutral", "good", "amazing"))
ggplot(priors, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..) / 19)) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
priors.state <- with(priors, table(imageID, stateRating)) / numSubjects
priors.states <- with(priors, table(imageID, stateRating)) / numSubjects
head(priors.states)
priors.states <- as.data.frame(with(priors, table(imageID, stateRating)) / numSubjects)
head(priors.states)
priors.states <- as.matrix(with(priors, table(imageID, stateRating)) / numSubjects)
head(priors.states)
comps <- princomp(data=priors, ~ sad + disgusted + angry + neutral + content + happy + excited, cor=FALSE, scores=TRUE)
summary(comps)
biplot(comps)
loadings(comps)
scores <- summary(comps)$scores
priors.pca <- cbind(priors, scores)
head(priors.pcs)
head(priors.pca)
priors.pca <- cbind(priors, scores)
priors.pca.long <-  melt(data=priors.pca, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory", "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.summary <- summarySE(priors.pca.long, measurevar="value",
groupvars=c("imageID", "imageCategory", "variable"))
head(priors.pca.summary)
ggplot(priors.pca.summary, aes(x=imageID, y=value, color=imageCategory)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2, color="black") +
geom_line(aes(group=variable), color="grey") +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
priors$imageID <- factor(priors$imageID)
priors.states <- as.matrix(with(priors, table(imageID, stateRating)) / numSubjects)
# affect ratings
comps <- princomp(data=priors, ~ sad + disgusted + angry + neutral + content + happy + excited, cor=FALSE, scores=TRUE)
summary(comps)
biplot(comps)
loadings(comps)
scores <- summary(comps)$scores
priors.pca <- cbind(priors, scores)
priors.pca.long <-  melt(data=priors.pca, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory", "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.summary <- summarySE(priors.pca.long, measurevar="value",
groupvars=c("imageID", "imageCategory", "variable"))
ggplot(priors.pca.summary, aes(x=imageID, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2, color="black") +
geom_line() +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
ggplot(priors.pca.summary, aes(x=imageID, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
#===== z-score
priors.pca.z <- cbind(priors, scores.z)
scores.z <- scale(scores)
priors.pca.z <- cbind(priors, scores.z)
priors.pca.z.long <-  melt(data=priors.pca.z, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory",  "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.z.summary <- summarySE(priors.pca.z.long, measurevar="value",
groupvars=c("imageID", "imageCategory", "variable"))
ggplot(priors.pca.z.summary, aes(x=imageID, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
scores.probit <- pnorm(scores.z)
priors.pca.probit <- cbind(priors, scores.probit)
priors.pca.probit.long <-  melt(data=priors.pca.probit, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory",  "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("imageID", "imageCategory", "variable"))
ggplot(priors.pca.probit.summary, aes(x=imageID, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
scores <- summary(comps)$scores
scores.z <- scale(scores)
scores.probit <- pnorm(scores.z)
priors.pca.probit <- cbind(priors, scores.probit)
priors.pca.probit.long <-  melt(data=priors.pca.probit, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory",  "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("stateRating", "variable"))
ggplot(priors.pca.probit.summary, aes(x=stateRating, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
head(priors.pca.probit.summary)
View(priors.pca.probit.summary)
sum(priors.pca.probit.summary$N)
sum(priors.pca.probit.summary$N) / 4
9 * 19
priors.states
ggplot(priors, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..) / 19)) +
ylab("probability") +
facet_grid(.~imageID) +
theme_bw()
ggplot(priors, aes(x=stateRating, fill=imageCategory)) +
geom_bar(aes(y = (..count..) / 19)) +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
ggplot(priors, aes(x=stateRating, fill="grey")) +
geom_bar(aes(y = (..count..) / 19)) +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
ggplot(priors, aes(x=stateRating)) +
geom_bar(aes(y = (..count..) / 19), fill="gray", color="black") +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
comps <- princomp(data=priors, ~ sad + disgusted + angry + neutral + content + happy + excited, cor=FALSE, scores=TRUE)
summary(comps)
biplot(comps)
ggplot(priors.pca.probit.summary, aes(x=stateRating, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
ggplot(priors, aes(x=stateRating)) +
geom_bar(aes(y = (..count..) / 19), fill="gray", color="black") +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
priors <- read.csv("../data/priors/long.csv")
numSubjects <- length(unique(priors$workerID))
priors$stateRating <- factor(priors$stateRating, labels=c("terrible", "bad", "neutral", "good", "amazing"))
priors$imageID <- factor(priors$imageID)
# plot distribution over states
ggplot(priors, aes(x=stateRating)) +
geom_bar(aes(y = (..count..) / 19), fill="gray", color="black") +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
numSubjects
ggplot(priors, aes(x=stateRating)) +
geom_bar(aes(y = (..count..) / 49), fill="gray", color="black") +
ylab("probability") +
facet_wrap(~imageID, ncol=3) +
theme_bw()
priors.states <- as.matrix(with(priors, table(imageID, stateRating)) / numSubjects)
# affect ratings
comps <- princomp(data=priors, ~ sad + disgusted + angry + neutral + content + happy + excited, cor=FALSE, scores=TRUE)
summary(comps)
biplot(comps)
loadings(comps)
scores <- summary(comps)$scores
scores.z <- scale(scores)
scores.probit <- pnorm(scores.z)
priors.pca.probit <- cbind(priors, scores.probit)
priors.pca.probit.long <-  melt(data=priors.pca.probit, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory",  "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("stateRating", "variable"))
ggplot(priors.pca.probit.summary, aes(x=stateRating, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
priors.states <- as.matrix(with(priors, table(imageID, stateRating)) / numSubjects)
View(priors.states)
priors.states
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("stateRating", "variable"))
scores <- summary(comps)$scores
scores.z <- scale(scores)
scores.probit <- pnorm(scores.z)
priors.pca.probit <- cbind(priors, scores.probit)
priors.pca.probit.long <-  melt(data=priors.pca.probit, id.vars=c("workerID", "gender", "age", "income", "language",
"order", "imageID", "imageCategory",  "stateRating"),
measure.vars=c("Comp.1", "Comp.2", "Comp.3", "Comp.4"))
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("stateRating", "variable"))
ggplot(priors.pca.probit.summary, aes(x=stateRating, y=value, color=variable)) +
#geom_bar(stat="identity", color="black") +
geom_point(size=2) +
geom_line(aes(group=variable)) +
geom_errorbar(aes(ymin=value-se, ymax=value+se), width=0.05) +
#facet_grid(variable ~ food) +
theme_bw()
priors.pca.probit.summary <- summarySE(priors.pca.probit.long, measurevar="value",
groupvars=c("stateRating", "variable"))
View(priors.pca.probit.summary)
